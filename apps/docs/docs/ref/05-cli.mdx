import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

# Verse CLI

The Verse CLI helps with design-time development and deployment tasks. It's primarily used to manage Migrations.

## Installing the Verse CLI

You should install the Verse cli locally as a dev dependency. The Verse cli can be installed by:

```bash npm2yarn
npm install @operativa/verse-cli --save-dev
```

Verify your installation by running:

```bash npm2yarn
npx verse
```

The output of the command will return the following help message:

```bash

  ██╗   ██╗ ███████╗ ██████╗  ███████╗ ███████╗
  ██║   ██║ ██╔════╝ ██╔══██╗ ██╔════╝ ██╔════╝
  ██║   ██║ █████╗   ██████╔╝ ███████╗ █████╗  
  ╚██╗ ██╔╝ ██╔══╝   ██╔══██╗ ╚════██║ ██╔══╝  
   ╚████╔╝  ███████╗ ██║  ██║ ███████║ ███████╗
    ╚═══╝   ╚══════╝ ╚═╝  ╚═╝ ╚══════╝ ╚══════╝

Usage: verse <command> [options]

Commands:
  verse init          Initializes the package with the base Verse model.
  verse migrations    Commands for managing migrations for the target database.
  verse query <expr>  Executes a verse query expression and outputs the results.
  verse model         Outputs a JSON representation of the model.

Options:
  -h, --help  Show help  [boolean]

```

## init

The `init` command initializes the package with the base Verse model. 

```bash npm2yarn
pnpm verse
```

The command will create a base Verse model file at the default location, `./src/model/index.ts`. This file will contain the Verse initilization function, driver, and model.
The file will export the `Verse` object on the default export, which can be used to interact with the database. This base model file can be adjusted to fit your application's needs. 

The file at `./src/model/index.ts` requires additional changes to specify the database driver and entity models.

### `verse.config.ts`

If the model location is changed or the verse object is changed such that it is no longer exported on the default export, then a `verse.config.ts` file should be created at the root of the package 
and export the verse model so that the cli can load the model correctly.

In the following example, the model has been moved to `./model.ts` and exported as a named export, `db`. The cli would not be able to find this automatically, so a `verse.config.ts` file must be created 
to load the model for the cli. The `verse.config.ts` file should export the model as `verse`:

```ts include ./apps/basic/verse.config.ts:verse-config showLineNumbers
import { db } from "./model.js";

export default {
  verse: db,
};
```

This file can include any other commands or initilization that might be required to load the Verse model. The file will be executed on each cli command.